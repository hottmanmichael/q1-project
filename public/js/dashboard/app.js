"use strict";!function(){function e(){t(),n(),a(),i()}function t(){var e=document.getElementById("page-title-artist-name");e.innerHTML=L.name}function n(){function e(e){var t=document.querySelector(".iframe-box.spotify-embed"),n=document.createElement("iframe");n.src="https://embed.spotify.com/?uri="+e,n.width="100%",n.height="100%",n.frameborder="0",n.style.border="none",n.allowtransparency="true",t.appendChild(n)}function t(){var e="album_type=album,single",t="&limit=10";new Ajax("GET",u+"/artists/"+L.id+"/albums?"+e+t,function(e,t){for(var i=0;i<t.items.length;i++)a(t.items[i],p.HEAR_IT.querySelector("#wheel-albums"));n(t.items)},null)}function n(e){var t=e.shift();new Ajax("GET",u+"/albums/"+t.id+"/tracks",function(t,a){return e.length>0?(r.push(a.items),void n(e)):void 0},null);var i=p.HEAR_IT.querySelector("#wheel-tracks");for(var l in r)for(var t=r[l],c=0;c<t.length;c++)a(t[c],i)}function a(e,t){var n=document.createElement("div");n.className=e.type+"-list-item",n.style.overflow="hidden";var a=document.createElement("h3");if(a.className="name","album"===e.type?("album"!==e.album_type&&(a.innerHTML=e.name+" ("+e.type+")"),a.innerHTML=e.name):a.innerHTML=e.name,"track"!==e.type&&e.images.length>0){var i=document.createElement("img");i.className="thumbnail",i.src=e.images[0].url,i.alt=e.name,i.height="40",i.width="40",n.appendChild(i)}var r=document.createElement("i");r.className="fa fa-play-circle-o play-item "+e.type,r.uri=e.uri,r.addEventListener("click",s),n.appendChild(a),n.appendChild(r),t.appendChild(n)}var i=u+"/artists/"+L.id;new Ajax("GET",i,function(n,a){e(a.uri),t()},null,!0);var r=[]}function a(){function e(e){var t=p.HEAR_IT.querySelector("#wheel-info"),n=0,a=document.createElement("div");a.className="topic";var i=document.createElement("h1");i.className="title",e.hasOwnProperty("name")?i.innerHTML=e.name:(i.innerHTML="Data not found.",n++);var r=document.createElement("p");r.className="description",e.hasOwnProperty("detailedDescription")?r.innerHTML=e.detailedDescription.articleBody:(r.innerHTML="No description available...",n++);var l=document.createElement("i");l.className="fa fa-globe",l.style["float"]="left",l.style.fontSize="2em",l.style.padding="5px";var c=document.createElement("a");e.hasOwnProperty("url")?(c.href=e.url,c.innerHTML=e.url.replace("http://","").replace("https://","")):(c.href="#",l.style.fontSize="0",n++),c.target="_blank",c.className="artist-website",c.style["float"]="left",c.style.fontSize="1.6em",c.style.padding="5px",c.style.textDecoration="none";var o=document.createElement("a");e.hasOwnProperty("detailedDescription")?(o.href=e.detailedDescription.url,o.innerHTML="Wikipedia"):(o.href="#",n++),o.target="_blank",r.appendChild(o);var s=document.createElement("a");e.hasOwnProperty("detailedDescription")?(s.href=e.detailedDescription.license,s.innerHTML="License: "+e.detailedDescription.license):(s.href="#",n++),s.className="wiki-license",s.target="_blank",5===n&&(r.innerHTML="This band is so hipster, you heard about them before Google did..."),a.appendChild(i),a.appendChild(r),a.appendChild(l),a.appendChild(c),a.appendChild(s);var d=document.createElement("div");d.className="image-box";var m=document.createElement("img");if(m.className="image-inner",e.hasOwnProperty("image")){m.src=e.image.contentUrl,m.alt=e.name;var u=document.createElement("a");u.innerHTML="Image License: "+e.image.license,u.target="_blank",d.appendChild(m),d.appendChild(u)}else a.style.width="100%",5===n&&(m.src="http://www.telegraph.co.uk/content/dam/men/2015/12/11/Cera1-large_trans++qVzuuqpFlyLIwiB6NTmJwZwVSIA7rSIkPn18jgFKEo0.jpg",m.alt="Hipster Michael Cera",a.style.width="65%",d.appendChild(m));t.appendChild(a),t.appendChild(d)}console.log("PAGE_ARTIST: ",L);var t=L.name.replace(/(\W+)/g,"+").toLowerCase(),n=v.replace("ARTIST",t);console.log("query: ",t),new Ajax("GET",n,function(t,n){t||(console.log("Artist Info: ",n.itemListElement[0].result),e(n.itemListElement[0].result))},null)}function i(){var e=g.ARTIST.replace("ARTIST",L.name.replace(/\s/g,"%20")),t=E+encodeURIComponent(g.BASE+e);new Ajax("GET",t,function(e,t){e||(console.log("RES: ",t),t.upcoming_event_count>0?r():c())},null)}function r(){var e=g.ALL_EVENTS.replace("ARTIST",L.name.replace(/\s/g,"%20")),t=E+encodeURIComponent(g.BASE+e);new Ajax("GET",t,function(e,t){e||(console.log("CONCERTS: ",t),l(t))},null)}function l(e){function t(e){console.log("concert: ",e);var t=document.createElement("li");t.className="concert-item";var a=document.createElement("h3");a.className="concert-title item-inner",a.innerHTML=e.formatted_location;var i=document.createElement("h3");i.className="concert-datetime item-inner",i.innerHTML=e.formatted_datetime;var r=document.createElement("div"),l=document.createElement("h4");l.className="text","available"===e.ticket_status?(r.className="seemore item-inner tix-true",l.innerHTML="Tickets Available"):(r.className="seemore item-inner tix-false",l.innerHTML="Tickets Unavailable"),r.appendChild(l),r.addEventListener("click",function(t){o(e)}),r.addEventListener("mouseenter",function(e){e.target.classList.add("flip")}),r.addEventListener("mouseleave",function(e){e.target.classList.remove("flip")}),t.appendChild(a),t.appendChild(i),t.appendChild(r),n.appendChild(t)}var n=document.createElement("ul");n.className="concert-list";for(var a=0;a<e.length;a++)t(e[a]);console.log("section seeit: ",p.SEE_IT),p.SEE_IT.querySelector(".seeit-inner").appendChild(n)}function c(){}function o(e){var t=document.createElement("div");t.className="concert-info";var n=document.createElement("div");n.className="title",n.innerHTML="<h2>"+e.title+"</h2>";var a=document.createElement("div");if(a.className="date",a.innerHTML="<p>"+e.formatted_datetime+"</p>",e.description){var i=document.createElement("div");i.className="description",i.innerHTML="<p>Event Description: "+e.description+"</p>"}var r=document.createElement("a");r.target="_blank";var l=document.createElement("div");l.className="tickets","available"===e.ticket_status?(r.href=e.ticket_url,l.innerHTML="Buy Tickets",l.classList.add("tix-true")):(l.innerHTML="Tickets Unavailable",l.classList.add("tix-false"),r.href="#"),r.appendChild(l);var c=document.createElement("a");c.target="_blank",c.href=e.facebook_rsvp_url;var o=document.createElement("img");o.className="facebook-logo",o.src="../assets/FB-f-Logo__blue_1024.png",c.appendChild(o),t.appendChild(n),t.appendChild(a),e.description&&t.appendChild(i),t.appendChild(r),t.appendChild(c);new Modal(t).show()}function s(e){document.querySelector("iframe").src="https://embed.spotify.com/?uri="+e.target.uri,d()}function d(){document.body.scrollTop=h}function m(){for(var e=0;e<b.length;e++)b[e].addEventListener("click",function(e){if(!e.target.classList.contains("active")){for(var t=0;t<w.length;t++)w[t].classList.contains("active")&&(w[t].classList.remove("active"),b[t].classList.remove("active"));console.log("e.target.for:",e.target.attributes.isFor.value);var n=e.target.attributes.isFor.value,a=document.getElementById("wheel-"+n);a.className+=" active fade",setTimeout(function(){a.classList.remove("fade")},10),e.target.className+=" active fade",setTimeout(function(){e.target.classList.remove("fade")},10)}})}var u="https://api.spotify.com/v1",p={HEAR_IT:document.getElementById("hearit"),SEE_IT:document.getElementById("seeit"),SING_IT:document.getElementById("singit"),DISCOVER_IT:document.getElementById("discoverit")},h=590,v="https://kgsearch.googleapis.com/v1/entities:search?query=ARTIST&key=AIzaSyAUrXU5tUMx8z9kuUq_uYKro-IHsTigorY&limit=5&indent=True&types=MusicGroup",f="&app_id=Groupie",g={BASE:"http://api.bandsintown.com/artists/",ARTIST:"ARTIST.json?api_version=2.0"+f,ALL_EVENTS:"ARTIST/events.json?api_version=2.0"+f},E="http://jsonp.afeld.me/?url=",T=new User;T.authenticated()||T.create(),T.establish(T.fetchLocal("MODEL")),console.log("user on page load and setup: ",T);var y=T.fetchLocal("CURRENT_ARTIST");console.log("artistFromStorage: ",y);var L=new Artist(y.id,y.name,y.slug);console.log("PAGE_ARTIST: ",L),e();var w=document.querySelectorAll(".wheel-item"),b=document.querySelectorAll(".content-wheel .navigation .list .item");m();var _=document.querySelector("header");window.addEventListener("scroll",function(){window.scrollY>50?_.classList.contains("darken")||(_.className+=" darken"):_.classList.remove("darken")})}();